# Инструкция по созданию шаблона Word для генерации документов

## Основные правила

1. **Переменные** обозначаются двойными фигурными скобками: `{{variable_name}}`
2. **Циклы для таблиц** используют специальный синтаксис: `{#TABLE_ROWS}...{/TABLE_ROWS}`

## Пример структуры шаблона для счета

### Простые переменные

\`\`\`
Бенефициар: {{beneficiary}}
ИИН/БИН: {{iin_bin}}
ИИК: {{iik}}
КБе: {{kbe}}
Банк бенефициара: {{bank}}
БИК: {{bik}}
Код назначения платежа: {{payment_code}}

Счет на оплату № {{invoice_number}} от {{invoice_date}}

Поставщик: {{supplier}}
ИИН/БИН: {{supplier_iin}}

Покупатель: {{customer_name}}
ИИН/БИН: {{customer_iin}}

Договор: {{contract}}
\`\`\`

### Таблица с товарами (цикл)

В Word создайте таблицу и в строке данных используйте:

\`\`\`
| № | Код | Наименование | Кол-во | Ед. изм. | Цена за ед. | Сумма |
|---|-----|--------------|--------|----------|-------------|-------|
| {#TABLE_ROWS}{{@index}} | {{code}} | {{name}} | {{quantity}} | {{unit}} | {{price}} | {{total}}{/TABLE_ROWS} |
\`\`\`

**Важно:** 
- Открывающий тег `{#TABLE_ROWS}` и закрывающий `{/TABLE_ROWS}` должны быть в одной строке таблицы
- Внутри цикла используйте переменные без префикса TABLE_ROWS
- `{{@index}}` автоматически добавляет номер строки (начиная с 0)

### Итоговые значения

\`\`\`
Итого: {{calculated_total}}
В том числе НДС: {{vat}}

Всего наименований {{items_count}}, на сумму {{calculated_total}} KZT
Всего к оплате: {{total_text}}

Исполнитель: {{executor}}
\`\`\`

## Доступные переменные

### Платежная информация
- `beneficiary` - Бенефициар
- `iin_bin` - ИИН/БИН бенефициара
- `iik` - ИИК (банковский счет)
- `kbe` - КБе
- `bank` - Банк бенефициара
- `bik` - БИК банка
- `payment_code` - Код назначения платежа

### Информация о счете
- `invoice_number` - Номер счета
- `invoice_date` - Дата счета
- `supplier` - Поставщик (полная информация)
- `supplier_iin` - ИИН/БИН поставщика
- `customer_name` - Наименование покупателя
- `customer_iin` - ИИН/БИН покупателя
- `contract` - Номер договора

### Таблица товаров (массив TABLE_ROWS)
Каждая строка содержит:
- `code` - Код товара
- `name` - Наименование
- `quantity` - Количество
- `unit` - Единица измерения
- `price` - Цена за единицу
- `total` - Сумма

### Итоговые значения
- `calculated_total` - Итоговая сумма (автоматически рассчитывается)
- `items_count` - Количество наименований
- `vat` - НДС
- `total_text` - Сумма прописью
- `executor` - Исполнитель

## Пример готового шаблона

Создайте документ Word со следующей структурой:

\`\`\`
ОБРАЗЕЦ ПЛАТЕЖНОГО ПОРУЧЕНИЯ

Бенефициар: {{beneficiary}}          ИИК: {{iik}}          КБе: {{kbe}}
ИИН/БИН: {{iin_bin}}
Банк бенефициара: {{bank}}           БИК: {{bik}}          Код назначения платежа: {{payment_code}}

СЧЕТ НА ОПЛАТУ № {{invoice_number}} от {{invoice_date}}

Поставщик: {{supplier}}
ИИН/БИН: {{supplier_iin}}

Покупатель: {{customer_name}}
ИИН/БИН: {{customer_iin}}

Договор: {{contract}}

[Таблица]
№ | Код | Наименование | Кол-во | Ед. изм. | Цена за ед. | Сумма
{#TABLE_ROWS}{{@index}} | {{code}} | {{name}} | {{quantity}} | {{unit}} | {{price}} | {{total}}{/TABLE_ROWS}

Итого: {{calculated_total}}
В том числе НДС: {{vat}}

Всего наименований {{items_count}}, на сумму {{calculated_total}} KZT
Всего к оплате: {{total_text}}

Исполнитель: {{executor}}
\`\`\`

## Устранение проблем

Если в документе появляется "undefined":
- Проверьте, что имя переменной в шаблоне точно совпадает с именем в списке выше
- Убедитесь, что используете двойные фигурные скобки `{{}}`, а не одинарные

Если таблица не заполняется:
- Убедитесь, что используете синтаксис цикла `{#TABLE_ROWS}...{/TABLE_ROWS}`
- Проверьте, что открывающий и закрывающий теги находятся в о��ной строке таблицы
- Внутри цикла используйте переменные без префикса (например, `{{name}}`, а не `{{TABLE_ROWS.name}}`)
